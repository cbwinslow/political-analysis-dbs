# =================================================================================================
# Name: Civic Legislative Stack - API Dockerfile
# Date: 2025-09-09
# File: Dockerfile
# Version: 0.3.0
# Log Summary:
#   - Builds runtime for civic_legis_stack.py with embeddings + ingestion.
# Description:
#   Lightweight Python image with required dependencies (pg, embeddings, parsing).
# Change Summary:
#   Initial creation.
# Inputs:
#   Source code + environment variables defined at runtime.
# Outputs:
#   Container exposing port 8090.
# =================================================================================================
FROM python:3.11-slim

WORKDIR /app
COPY civic_legis_stack.py /app/

RUN apt-get update && apt-get install -y --no-install-recommends build-essential git curl \
    && rm -rf /var/lib/apt/lists/*

RUN pip install --no-cache-dir requests tqdm psycopg2-binary pydantic fastapi uvicorn python-dotenv \
    sentence-transformers numpy scikit-learn beautifulsoup4 lxml PyPDF2 neo4j

EXPOSE 8090
CMD ["python", "civic_legis_stack.py", "--serve", "--port", "8090"]